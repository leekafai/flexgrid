## 目标
- 修复卡片重叠与尺寸不一致问题（统一参数、层级与容器高度）。
- 基于同一数据源（bento_data.json）实现两套布局并可切换：Grid 行布局 vs Position 绝对定位。
- 完成对比测试与性能采集，在不同设备与断点下验证交互与稳定性，并输出选型建议。

## 改动概览
- 参数统一：将 `unit/gap/columns` 在逻辑层与样式层一致，避免拖拽宽高与视觉栅格不匹配。
- 行初始化与自动流：确保添加/移动卡片后初始化行；为 `.bento-grid__row` 增加 `grid-auto-flow: row dense` 提升紧凑性。
- 层级策略：普通卡片设基础层级，悬停与拖拽统一提升，阴影层次清晰，避免遮挡异常。
- 绝对定位布局：实现坐标→像素映射、容器显式高度、拖拽坐标更新与碰撞/吸附。
- 响应式断点：建立断点表（mobile/tablet/desktop）并统一列宽与单位缩放策略。

## Phase 1：Grid 行布局基线修复
- 统一 `gap`：将逻辑层默认 `gap:8` 与样式层 `gap:20px` 对齐（以 20 为准），或改为由 `grid.gap` 驱动 CSS 变量。
- 行初始化：在增删改卡片后调用 `initializeRows()`，避免回退到旧结构导致错位。
- 自动流配置：为 `.bento-grid__row` 增加 `grid-auto-flow: row dense`，减少空洞与潜在覆盖。
- 层级与容器：普通卡片设基础 `z-index`；拖拽中卡片与阴影统一层级；顶层容器保留最小高度但不影响行自然撑开。
- 验证：通过 TestNewGrid 页面，检查不重叠、统一间距与尺寸、拖拽插入与保留空行行为。

## Phase 2：Position 绝对定位布局（对齐 bento.me）
- 数据接入：解析 `bento_data.json` 获取卡片 `x/y` 与尺寸（units 或 width/height）。
- 映射函数：实现 `coordToPixels(x,y,w,h, unit,gap, columns)` 返回 `left/top/width/height`；拖拽中按指针更新坐标并回写映射。
- 容器高度：按所有卡片的最大 `y+height` 计算内容高度并设置到内容容器，确保绝对定位项可见。
- 重叠策略：允许相同坐标的卡片；按类型或顺序控制 z-index；拖拽态提升层级。
- 响应式：断点下重算 `columns/unit/gap` 与映射，或等比缩放坐标以保持相对位置。
- 验证：构建 Position 演示页，加载同一数据集并进行拖拽与插入测试。

## Phase 3：响应式与断点一致性
- 断点表：
  - mobile：`columns=4`, `unit=36`, `gap=16`
  - tablet：`columns=8`, `unit=40`, `gap=18`
  - desktop：`columns=12`, `unit=44`, `gap=20`
- 统一策略：Grid 与 Position 两方案共用断点表与单位，避免宽度变化导致卡片尺寸漂移。

## Phase 4：测试与指标采集
- 用例：插入/跨行拖拽/重叠显示/保留空行；三档断点布局一致性与拖拽顺滑度。
- 性能：采集渲染耗时、拖拽帧率（requestAnimationFrame 统计）、内存（`performance.memory` 如可用）。
- 兼容性：Chrome/Firefox/Safari/Edge；触摸与高 DPI 设备。

## 交付物
- 可切换的演示（Grid vs Position），统一参数与断点策略。
- 坐标驱动渲染（接入 bento_data.json）与容器高度管理。
- 对比测试结果与性能数据报告。
- 选型结论：若追求自由坐标与重叠能力，建议 Position；若维护成本与响应式稳定优先，建议 Grid。

请确认开始按以上阶段逐步实施。确认后我将：统一参数与行初始化、完善 Grid；实现 Position 映射与容器管理；搭建对比与采集测试，并输出报告与选型建议。